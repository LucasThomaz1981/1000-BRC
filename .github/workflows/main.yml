name: 1000-BRC Protocolo Nuclear
on: [workflow_dispatch]

jobs:
  liquidate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: Instalar Dependências
        run: |
          pip install requests bitcoinlib bitcoin-utils

      - name: Executar Varridura e Liquidação
        run: |
          # Executa o scanner e filtra as linhas que contêm o HEX gerado
          python3 api_broadcast_system.py > output.txt
          cat output.txt
          
          grep "HEX_GEN:" output.txt | cut -d':' -f2 | while read HEX; do
            echo "Transmitindo Transação Encontrada..."
            curl -s -X POST https://www.viabtc.com/res/tools/v1/broadcast -d "raw_tx=$HEX"
          done
